/-
```

elementwise mul

+-------+-------+-------------------+------+
|   OP  | DEPTH |       INPUT       | WORK |
+-------+-------+-------------------+------+
|       |       |                   |      |
|  LOAD |   1   | [a_1 a_2 ... a_i] |  n   |
|  LOAD |   1   | [b_1 b_2 ... b_i] |  n   |
|  MUL  |   1   |    *  *      *    |  n   |
| STORE |   1   | [c_1 c_2 ... c_i] |  n   |
|       |       |                   |      |
+-------+-------+-------------------+------+
| TOTAL |   4   |                   |  4n  |
+-------+-------+-------------------+------+
| ASYMP |  O(1) |                   | O(n) |
+-------+-------+-------------------+------+
  


*------------*---------*-----------------------------------*------------*
|  op        |  depth  |                  input            |    work    |
*------------*---------*-----------------------------------*------------*
| LOAD       |    1    | [a₁     a₂     a₃     a₄  ⋯  aᵢ]  |     n/2    |
|            |         |  \     /       \     /       /    |            |
| PAIRWISE + |    1    |  [a₁+a₂         a₃+a₄   ⋯  ]      |     n/4    |
|            |         |     \           /        /        |            |
| PAIRWISE + |    1    |     [(a₁+a₂)+(a₃+a₄) ⋯ ]          |     n/8    |
|            |         |           \   /                   |            |
|  ⋯         |    ⋯    |             ⋯                     |      ⋯     |
|            |         |             |                     |            |
| PAIRWISE + |    1    |            [∑a]                   |      1     |
| STORE      |    1    |            [∑a]                   |      1     |
*------------*---------*-----------------------------------*------------*
|  TOTAL     | log n+1 |                                   |     n+1    |
*------------*---------*-----------------------------------*------------*
|  ASYMP     | O(log n)|                                   |     O(n)   |
*------------*---------*-----------------------------------*------------*




*--------*-------*------------------------*------*
|  op    | depth |     input              | work |
*--------*-------*------------------------*------*
|        |       |                        |      |
|  LOAD  |   1   | [a₁₁ a₁₂ ⋯ a₁ⱼ ⋯ aᵢⱼ]  |  n   |
|  LOAD  |   1   | [b₁₁ b₁₂ ⋯ b₁ⱼ ⋯ bᵢⱼ]  |  n   |
|  MUL   |   1   |  *  *      *     *     |  n   |
|  STORE |   1   | [c₁₁ c₁₂ ⋯ c₁ⱼ ⋯ cᵢⱼ]  |  n   |
|        |       |                        |      |
*--------*-------*------------------------*------*
|  TOTAL |   4   |                        |  4n  |
*--------*-------*------------------------*------*
|  ASYMP |  O(1) |                        | O(n) |
*--------*-------*------------------------*------*



*--------*-------*--------------------------------*--------*
|  op    | depth |     input                      |  work  |
*--------*-------*--------------------------------*--------*
|        |       |                                |        |
|  LOAD  |   1   | [a₁₁ a₁₂ ⋯ a₁ⱼ ⋯ aᵢⱼ]          |  n²    |
|  LOAD  |   1   | [b₁₁ b₁₂ ⋯ b₁ₖ ⋯ bⱼₖ]          |  n²    |
|  MUL   |   1   |  *   *     *     *             |  n³    |
|  STORE |   1   | [c₁₁₁ c₁₁₂ ⋯ c₁ⱼₖ ⋯ cᵢⱼₖ]      |  n³    |
|        |       |                                |        |
*--------*-------*--------------------------------*--------*
|  TOTAL |   4   |                                | 2n²+2n³|
*--------*-------*--------------------------------*--------*
|  ASYMP |  O(1) |                                | O(n³)  |
*--------*-------*--------------------------------*--------*

*--------------*-----------*--------------------------*--------*
|  op          | depth     |     input                | work   |
*--------------*-----------*--------------------------*--------*
|              |           |                          |        |
|  LOAD        |   1       | [a₁₁ a₁₂ ⋯ a₁ⱼ ⋯ aᵢⱼ]    |  n²    |
|  LOAD        |   1       | [b₁₁ b₁₂ ⋯ b₁ₖ ⋯ bⱼₖ]    |  n²    |
| TENSOR       |   1       |       "ij,jk->ijk"       |  n³    |
|              |           |                          |        |
| CONTRACTION  | log n     |        "ijk->ik"         |  n³    |
| STORE        |   1       | [d₁₁ d₁₂ ⋯ d₁ₖ ⋯ dᵢₖ]    |  n²    |
|              |           |                          |        |
*--------------*-----------*--------------------------*--------*
|  TOTAL       | logn +4   |                          | 2n²+2n³|
*--------------*-----------*--------------------------*--------*
|  ASYMP       | O(log n)  |                          | O(n³)  |
*--------------*-----------*--------------------------*--------*


*--------------*-----------*--------------------------------*--------*
|  op          | depth     |     input                      | work   |
*--------------*-----------*--------------------------------*--------*
|  LOAD        |   1       | x ∈ ℝⁿ                         |   n    |
|  MAX         |  log n    | m = max(x)                     |   n    |
|  SUB         |   1       | x' = x - m                     |   n    |
|  EXP         |   1       | e = exp(x')                    |   n    |
|  SUM         |  log n    | s = sum(e)                     |   n    |
|  DIV         |   1       | y = e / s                      |   n    |
|  STORE       |   1       | y ∈ ℝⁿ                         |   n    |
*--------------*-----------*--------------------------------*--------*
|  TOTAL       | 2log n+5  |                                |  7n    |
*--------------*-----------*--------------------------------*--------*
|  ASYMP       | O(log n)  |                                | O(n)   |
*--------------*-----------*--------------------------------*--------*


*--------------*-----------*--------------------------------*-----------*
|  op          | depth     |     input                      | work      |
*--------------*-----------*--------------------------------*-----------*
|  LOAD        |   1       | X ∈ ℝᵇˣⁿˣᵈ                     |  bnd      |
|  LOAD        |   1       | Wq,Wk,Wv ∈ ℝᵈˣᵈ                |  3d²      |
|  MATMUL      | 3log d    | Q = X·Wq ; K = X·Wk ; V = X·Wv |  3bnd²    |
|  MATMUL      | log d     | S = Q·Kᵀ                       |  bn²d     |
|  DIV         |   1       | S' = S / √d                    |  bn²      |
|  SOFTMAX     | log n     | A = softmax(S')                |  bn²      |
|  MATMUL      | log n     | O = A·V                        |  bn²d     |
|  STORE       |   1       | O ∈ ℝᵇˣⁿˣᵈ                     |  bnd      |
*--------------*-----------*--------------------------------*-----------*
|  TOTAL       | 4log d +  |                                |           |
|              | 2log n + 5|                                |  ≈ bn²d   |
*--------------*-----------*--------------------------------*-----------*
|  ASYMP       | O(logd)   |                                | O(bn²d)   |
|              | if d >>n  |                                |           |
*--------------*-----------*--------------------------------*-----------*

-/
